I"Æ<p>æ ‘è“æ´¾æ˜¯ä¸€å°ç”µè„‘ï¼Œå°ºå¯¸åªæœ‰é“¶è¡Œå¡å¤§å°ï¼Œæ ‘è“æ´¾ä¼˜ç§€çš„å¯æ‰©å±•æ€§ç»™äº†äººä»¬æå¤§çš„å‘æŒ¥ç©ºé—´ï¼Œä½ å¯ä»¥åœ¨æ ‘è“æ´¾ä¸Šéƒ¨ç½²ä»»ä½•ä½ èƒ½æƒ³åˆ°çš„é¡¹ç›®ã€å„ç§geekå¤©é©¬è¡Œç©ºçš„ç©æ³•ã€‚<br />
<!-- more --></p>
<h2 id="piçš„åŸºæœ¬ä»‹ç»">piçš„åŸºæœ¬ä»‹ç»</h2>
<p>ä¸€ä¸ªæ ‘è“æ´¾å¯åŠ¨æ‰€å¿…é¡»çš„é…ä»¶åŒ…æ‹¬ï¼šä¸€ä¸ª8Gçš„TFå¡ç”¨äºè£…ç³»ç»Ÿã€ä¸€ä¸ª5V2.5Açš„ç”µæºã€å†åŠ ä¸€ä¸ªäºšå…‹åŠ›å¤–å£³ï¼Œæœ€å¥½å†é…ä¸ªæ•£çƒ­ç‰‡ï¼Œäº²æµ‹åŠ ä¸Šæ•£çƒ­ç‰‡æ—¥å¸¸å¼€æœºè¿è¡Œä¸ä¼šè¶…è¿‡55Â°ã€‚<br />
<img src="/images/raspberry_2.jpg" alt="" />
æ ‘è“æ´¾3Bé‡‡ç”¨äº†BCM2837 1.2GHzå››æ ¸A53 64ä½å¤„ç†å™¨ï¼Œ1GB RAMå’ŒVideoCore IV GPUï¼Œå†…ç½®Wi-Fiå’Œè“ç‰™ã€‚<br />
<img src="/images/raspberry_3.jpg" alt="" /></p>
<h2 id="åˆè¯•æ ‘è“æ´¾">åˆè¯•æ ‘è“æ´¾</h2>
<p>æ ‘è“æ´¾æ‹¥æœ‰å¼ºå¤§çš„ç¤¾åŒºèµ„æºï¼Œå› æ­¤å¯ä¾›é€‰æ‹©çš„ç³»ç»Ÿä¸å°‘ï¼ŒåŒ…æ‹¬å®˜æ–¹raspbianã€archã€ridoraã€ä»¥åŠwin10 IOTã€ç”šè‡³åŒ…æ‹¬android4.4åŸç”Ÿã€‚æˆ‘é€‰çš„æ˜¯å®˜æ–¹æ¨èçš„<a href="https://www.raspberrypi.org/downloads/">raspbiané•œåƒ</a>ï¼Œå¦‚æœé€‰raspbianï¼Œå®˜æ–¹æä¾›äº†ä¸¤ä¸ªç‰ˆæœ¬ WITH PIXELå’ŒLITEï¼Œå‰è€…æ˜¯å¸¦å›¾å½¢ç•Œé¢çš„ã€‚
<img src="/images/raspberry_4.jpg" alt="" />
å°†é•œåƒä¸‹è½½ä¸‹æ¥ä¹‹åï¼Œä½¿ç”¨å®˜æ–¹æ¨èçš„<a href="https://sourceforge.net/projects/win32diskimager/">Win32DiskImager</a>åˆ»åˆ°sdå¡ã€‚ç„¶åæ’ä¸Šç”µæºç­‰å¾…å¼€æœºã€‚æ¥ä¸‹æ¥ï¼Œæ‰¾åˆ°ä¸€æ ¹ç½‘çº¿ï¼Œè¿æ¥åˆ°è·¯ç”±å™¨ï¼Œä»è·¯ç”±å™¨çš„ç®¡ç†ç•Œé¢è·å–åˆ°piçš„ipã€‚<br />
æ¥ç€æ‰“å¼€<a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">PuTTY</a> ï¼Œè¾“å…¥ipï¼Œç«¯å£å¡«22ï¼Œé€‰sshï¼Œç¡®è®¤è¿›å…¥ã€‚ï¼ˆå¯¹äº†ï¼Œæ–°ç‰ˆjessieæ˜¯é»˜è®¤å…³é—­sshçš„ï¼Œæ‰€ä»¥å¦‚æœè¿æ¥ä¸ä¸Špiï¼Œé‚£ä¹ˆæ‹”æ‰ç”µæºï¼Œç»™piçš„sdå¡ä¸Šæ–°å»ºä¸€ä¸ªåä¸ºSSHæ²¡æœ‰åç¼€çš„æ–‡ä»¶ï¼‰ã€‚<br />
ok,è¿æ¥ä¸Šä»¥åæ ‘è“æ´¾çš„é»˜è®¤ç”¨æˆ·åæ˜¯piï¼Œå¯†ç æ˜¯raspberryã€‚ç™»å½•ä¸Šä»¥åï¼Œé¦–å…ˆæˆ‘ä»¬å¾—å…ˆæ›´æ”¹è½¯ä»¶æºï¼Œå®˜æ–¹çš„æºæ…¢çš„è·Ÿèœ—ç‰›ä¸€æ ·ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo nano /etc/apt/sources.list

deb http://mirrors.aliyun.com/raspbian/raspbian/ jessie main non-free contrib rpi
deb-src http://mirrors.aliyun.com/raspbian/raspbian/ jessie main non-free contrib rpi

//ctrl+oä¿å­˜ ç›´æ¥æŒ‰enterä¸æ›´æ”¹æ–‡ä»¶å ctrl+xé€€å‡º

sudo apt-get update //æ›´æ–°è½¯ä»¶ç´¢å¼•æ¸…å•
</code></pre></div></div>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„å·¥ä½œæ˜¯å¯ç”¨wifiï¼Œè¿™æ ·å°±å¯ä»¥æ„‰å¿«çš„æ‹”æ‰ç½‘çº¿ç©å•¦ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo iwlist wlan0 scan      //æ‰«æwifi

sudo nano /etc/wpa_supplicant/wpa_supplicant.conf //ä¿®æ”¹wifié…ç½® 

network={  
    ssid="XXXX"  
    psk="XXXX" 
    scan_ssid=1 å¦‚æœè¿æ¥çš„wifiæ˜¯éšè—çš„ï¼Œå°±å¾—å†™ä¸Šè¿™ä¸ª

} 
//æ·»åŠ wifiçš„ç”¨æˆ·åå’Œå¯†ç 
</code></pre></div></div>
<p>ok,æ¥ä¸‹æ¥æˆ‘ä»¬é‡å¯æ ‘è“æ´¾å°±å¯ä»¥æ‹”æ‰ç½‘çº¿äº†<code class="language-plaintext highlighter-rouge">sudo reboot</code><br />
è¿æ¥å¥½wifiä¹‹åå‘¢ï¼Œæˆ‘ä»¬åªè¦è£…ä¸Šxrdpå¯ä»¥æ›´å¥½åœ°è°ƒæˆï¼Œå•Šå‘¸ï¼Œè°ƒè¯•æ ‘è“æ´¾ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt-get install xrdp
sudo apt-get install vnc4server tightvncserver
</code></pre></div></div>
<p>è£…å¥½ä»¥åï¼Œæ‰“å¼€windowsè‡ªå¸¦çš„è¿œç¨‹æ¡Œé¢è¿æ¥ï¼Œè¾“å…¥piçš„ipï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç‚¹å‡»ç¡®è®¤ã€‚æ¥ä¸‹æ¥å°±å¯ä»¥çœ‹åˆ°piçš„åºå±±çœŸé¢ç›®äº†ã€‚
<img src="/images/raspberry_5.jpg" alt="" /></p>
<h2 id="ä¸Šæ‰‹æ ‘è“æ´¾">ä¸Šæ‰‹æ ‘è“æ´¾</h2>
<p>è¶çƒ­æ‰“é“ï¼Œåœ¨piä¸Šéƒ¨ç½²ä¸€ä¸ªå°åº”ç”¨â€”èµ·åºŠé—¹é’Ÿã€‚éœ€æ±‚ï¼šä¸€ä¸ªå°éŸ³å“<br />
æ€è·¯æ˜¯ç”¨pythonçš„requestsåº“çˆ¬å–å¢¨è¿¹å¤©æ°”å½“å¤©çš„å¤©æ°”çŠ¶å†µï¼Œç„¶ååˆ©ç”¨ç™¾åº¦å¤§è„‘çš„è¯­éŸ³åˆæˆç”ŸæˆéŸ³é¢‘ï¼Œç„¶ååœ¨æ ‘è“æ´¾ä¸Šé‡‡ç”¨å®šæ—¶ä»»åŠ¡ï¼Œæ’­æ”¾éŸ³é¢‘ã€‚åŒæ—¶ä¹Ÿå¯ä»¥é¡ºæ‰‹æ¥å‡ é¦–music</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># encoding=utf-8
import requests
import os
from bs4 import BeautifulSoup
import re
import datetime
import time


def gethtml(url):
    s = requests.get(url)
    return s.text


def retest(html):
    aqilevelpatten = 'src="https://h5tq.moji.com/tianqi/assets/images/aqi/(\d)'
    aqilevel = re.findall(aqilevelpatten, html)[0]
    print(aqilevel)

    aqipatten = '/aqi/' + aqilevel + '\.png"\s*alt="(\d* \w*)'
    aqi = re.findall(aqipatten, html)[0]
    print(aqi)

    aboutpatten = 'wea_about clearfix"&gt;\s*&amp;lt;span&gt;(\w* \w*%)&amp;lt;/span&gt;\s*&amp;lt;em&gt;(\w*)'
    about = re.findall(aboutpatten, html)  # [('æ¹¿åº¦ 8%', 'åŒ—é£3çº§')]
    humidity = about[0][0]
    windy = about[0][1]
    print(humidity)
    print(windy)

    tippatten = ' &amp;lt;div class="wea_tips clearfix"&gt;\s*&amp;lt;span&gt;\w*&amp;lt;/span&gt;\s*&amp;lt;em&gt;(\w*ï¼Œ?\w*)'
    tip = re.findall(tippatten, html)[0]
    print(tip)

    list_weather = [aqi, humidity, windy, tip]
    today = datetime.date.today()
    print(today)
    with open("weather.txt", 'a', encoding='utf-8')as f:
        f.write(str(today) + ':')
        f.write(str(list_weather)+"\n")

    return list_weather

def tts(weather):
    #+" æ¹¿åº¦"weather[1]
    text="å¼ºå“¥ æ—©ä¸Šå¥½ è¯¥èµ·åºŠå•¦"+"ä»Šå¤©ç©ºæ°”è´¨é‡æŒ‡æ•° æ˜¯"+str(weather[0])+" é£åŠ› ä¸º"+str(weather[2])+" è‚šå­æé†’ä½ ï¼Œ"+str(weather[3])
    headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit'
                          '/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safar'
                          'i/537.36',
        }
    url_2='http://tts.baidu.com/text2audio?idx=1&amp;amp;tex=(%s)&amp;amp;cuid=baidu_speech_demo&amp;amp;cod=2&amp;amp;lan=zh&amp;amp;ctp=1&amp;amp;pdt=1&amp;amp;spd=5&amp;amp;per=4&amp;amp;vol=5&amp;amp;pit=5'%text
    url = 'http://tts.baidu.com/text2audio?idx=1&amp;amp;tex=%E5%BC%BA%E5%93%A5%20%E6%97%A9%E4%B8%8A%E5%A5%BD%20%E8%AF%A5%E8%B5%B7%E5%BA%8A%E5%95%A6&amp;amp;cuid=baidu_speech&amp;amp;cod=2&amp;amp;lan=zh&amp;amp;ctp=1&amp;amp;pdt=1&amp;amp;spd=5&amp;amp;per=4&amp;amp;vol=4&amp;amp;pit=5'
    res = requests.get(url_2, headers=headers)
    with open('1.mp3', 'wb') as f:
        #print(res.content)
        f.write(res.content)
if __name__ == '__main__':
    #os.chdir('d:\\')
    url = 'http://tianqi.moji.com/'
    html = gethtml(url)
    weather = retest(html)
    tts(weather)
</code></pre></div></div>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨æ ‘è“æ´¾é‡Œè®¾ç½®å®šæ—¶ä»»åŠ¡ã€‚</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crontab -e

00 06 * * * python3 /root/weather/weather.py
01 06 * * * mplayer /root/weather/morning.mp3 /root/weather/1.mp3
03 06 * * * mplayer -shuffle /root/Misic/*.mp3
30 06 * * * pkill mplayer
</code></pre></div></div>
<p>å“¦ï¼Œå·®ç‚¹å¿˜äº†è£…æ’­æ”¾å™¨<code class="language-plaintext highlighter-rouge">sudo apt-get install mplayer</code><br />
æ¥ä¸‹æ¥ï¼Œå°±å¯ä»¥åä¸‹æ¥é™é™çš„ç­‰ç€é»æ˜çš„åˆ°æ¥ï¼Œä¼´ç€æ¸…æ™¨çš„å¾®å…‰ï¼Œæ»¡æ€€æœŸæœ›çš„ç­‰å¾…æ ‘è“æ´¾å–Šä½ èµ·åºŠ. 0_0</p>
:ET